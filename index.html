<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kota Berbicara - Smart City Podcast Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #2962ff;
            --primary-dark: #0039cb;
            --secondary: #00bfa5;
            --dark: #263238;
            --light: #f5f5f5;
            --gray: #9e9e9e;
            --success: #66bb6a;
            --warning: #ffa726;
            --danger: #ef5350;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem 0;
            border-radius: 0 0 var(--radius) var(--radius);
            box-shadow: var(--shadow);
            width: 100%;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo i img{
            width: 120px;   /* atur lebar logo */
            height: auto;
            max-width: 100px;
            font-size: 2.5rem;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: opacity 0.3s;
        }

        .nav-links a:hover {
            opacity: 0.8;
        }

        .main-content {
            margin: 2rem 0;
            width: 100%;
        }

        .app-intro {
            text-align: center;
            margin-bottom: 2rem;
        }

        .app-intro h2 {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .app-intro p {
            max-width: 800px;
            margin: 0 auto;
            color: var(--dark);
            line-height: 1.6;
        }

        .tabs {
            display: flex;
            margin-bottom: 2rem;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .tab-btn {
            flex: 1;
            background: white;
            border: none;
            padding: 1rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        .tab-btn:hover:not(.active) {
            background: #f0f0f0;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            
        }

        .tab-content.active {
            display: block;
            /* display: flex; */
            justify-content: space-between; /* konten kiri & tombol kanan */
            align-items: center; 
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: border 0.3s;
        }

        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            border-color: var(--primary);
            outline: none;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        .file-upload {
            border: 2px dashed #ddd;
            border-radius: var(--radius);
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .file-upload:hover {
            border-color: var(--primary);
        }

        .file-upload i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .file-upload p {
            margin-bottom: 0.5rem;
        }

        .file-upload input {
            display: none;
        }

        .file-list {
            margin-top: 1rem;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f9f9f9;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }

        .file-item i {
            color: var(--danger);
            cursor: pointer;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .podcast-video-title {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
}
.podcast-video-meta {
  display: flex;
  justify-content: space-between; /* city on left, duration on right */
  align-items: center;
  padding: 4px 0px; /* optional spacing */
}
.duration-label {
  position: absolute;
  bottom: 8px;
  right: 8px;
  background: rgba(0, 0, 0, 0.281);
  color: #fff;
  padding: 2px 8px;
  border-radius: 6px;
  font-size: 0.8rem;
}
.accent-info {
    background: #f3f4f6;
    color: #111;
    padding: 2px 6px;
    border-radius: 6px;
    font-size: 0.7rem;
}
        .button-wrapper {
            margin-right: auto; /* dorong ke kanan */
        }
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .speaker-selection {
            margin-top: 1rem;
            margin-bottom: 1rem;
        }

        .speaker-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .speaker-card {
            border-radius: var(--radius);
            overflow: hidden;
            background: white;
            padding: 1rem;
            box-shadow: var(--shadow);
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .speaker-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .speaker-card.selected {
            border: 2px solid var(--primary);
        }

        .speaker-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            margin: 0 auto 1rem;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--primary);
            border: 3px solid #f0f0f0;
        }

        .speaker-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .speaker-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .speaker-desc {
            color: var(--gray);
            font-size: 0.85rem;
        }

        .range-slider {
            width: 100%;
            margin-top: 0.5rem;
        }

        .range-info {
            display: flex;
            justify-content: space-between;
            margin-top: 0.25rem;
            font-size: 0.85rem;
            color: var(--gray);
        }

        .podcast-result {
            margin-top: 2rem;
            padding: 2rem;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        /* Podcast display yang baru mirip YouTube */
        #podcastContainer {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .podcast-video-card {
            border-radius: var(--radius);
            overflow: hidden;
            background: white;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .podcast-video-card:hover {
            transform: translateY(-5px);
        }

        .podcast-thumbnail {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            background-color: #ffffff;
            overflow: hidden;
        }

        .podcast-thumbnail img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .podcast-thumbnail .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .podcast-thumbnail:hover .play-overlay {
            opacity: 1;
        }

        .city-label {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            z-index: 2;
        }

        .play-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .podcast-video-info {
            padding: 15px;
        }

        .podcast-video-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            max-height: 2.8em; /* Fallback */
        }

        .podcast-video-speaker {
            display: flex;
            justify-content: space-between;
            color: var(--gray);
            font-size: 13px;
            margin-bottom: 8px;
        }

        .podcast-video-meta {
            display: flex;
            justify-content: space-between;
            color: var(--gray);
            font-size: 13px;
        }
        .podcast-player {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #f6f6f6, #ffffff);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        .play-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .play-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .podcast-info {
            flex: 1;
        }

        .podcast-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .podcast-meta {
            display: flex;
            gap: 1rem;
            color: var(--gray);
            font-size: 0.85rem;
        }

        .progress-container {
            flex: 1;
            height: 5px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-top: 1rem;
            position: relative;
            cursor: pointer;
        }

        .progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--primary);
            border-radius: 10px;
            width: 0%;
            cursor: pointer;
        }
        .progress-bar::after {
            content: '';
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .progress-container:hover .progress-bar::after,
        .progress-container.dragging .progress-bar::after {
            opacity: 1;
        }

        /* Prevent text selection while dragging */
        .progress-container.dragging {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            cursor: grabbing;
        }
        .duration {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--gray);
        }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
            margin: 0 auto 1rem auto;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            font-size: 1.2rem;
            color: var(--gray);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:focus + .toggle-slider {
            box-shadow: 0 0 1px var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        .toggle-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .toggle-label span {
            flex: 1;
        }

        .download-progress {
            margin-top: 1.5rem;
            text-align: center;
            padding: 2rem;
            background: #f9f9f9;
            border-radius: var(--radius);
            display: none;

            
        }

        .download-progress.active {
            display: block;
        }

        .download-progress .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .download-progress .progress-bar-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .download-success {
            text-align: center;
            margin-top: 1.5rem;
            display: none;
        }

        .download-success.active {
            display: block;
        }

        .download-success i {
            font-size: 3rem;
            color: var(--success);
            margin-bottom: 1rem;
        }

        .category-tag {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            background: rgba(0, 191, 165, 0.1);
            color: var(--secondary);
            border-radius: 50px;
            font-size: 0.8rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-tag:hover {
            background: rgba(0, 191, 165, 0.2);
        }

        .category-tag.active {
            background: var(--secondary);
            color: white;
            font-weight: bold;
        }

        .city-modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .city-modal {
            background: white;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .city-modal-header {
            padding: 1.5rem;
            background: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .city-modal-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .city-modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .city-modal-body {
            padding: 1.5rem;
            overflow-y: auto;
        }

        .city-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        .city-search {
            margin-bottom: 1rem;
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-family: 'Poppins', sans-serif;
        }

        /* Search box */
        .search-box {
            display: flex;
            margin-bottom: 1rem;
        }

        .search-box input {
            flex: 1;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: var(--radius) 0 0 var(--radius);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
        }

        .search-box button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0 1.5rem;
            border-radius: 0 var(--radius) var(--radius) 0;
            cursor: pointer;
            transition: background 0.3s;
        }

        .search-box button:hover {
            background: var(--primary-dark);
        }

        footer {
            background: var(--dark);
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
            width: 100%;
        }

        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 2rem;
        }

        .footer-col {
            flex: 1;
            min-width: 200px;
        }

        .footer-col h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--secondary);
        }

        .footer-col p {
            margin-bottom: 1rem;
            text-align: justify;
            line-height: 1.6;
            color: #b0bec5;
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s;
        }

        .social-icon:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .copyright {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #b0bec5;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            .tabs {
                flex-direction: column;
            }

            .podcast-player {
                flex-direction: column;
                text-align: center;
            }

            .podcast-meta {
                justify-content: center;
            }

            #podcastContainer {
                grid-template-columns: 1fr;
            }

            .city-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .slide-up {
            animation: slideUp 0.5s ease-in-out;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--dark);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success {
            background: var(--success);
        }

        .toast.error {
            background: var(--danger);
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">
                <img src="https://dbdlxpquyiwpntlsizle.supabase.co/storage/v1/object/public/assets/Kota%20Berbicara(4).png" width="80px" alt="">
                <!-- <i class="fas fa-city"></i> -->
                <h1>Kota Berbicara</h1>
            </div>
            <div class="nav-links">
                <a href="#" data-target="podcastContainer"><i class="fas fa-podcast"></i> Podcast Terbaru</a>
                <a href="#" data-target="footer"><i class="fas fa-info-circle"></i> Tentang</a>
                <a href="#" data-target="footer"><i class="fas fa-envelope"></i> Kontak</a>
            </div>
        </div>
    </header>

    <main class="container main-content">
        <div class="app-intro slide-up">
            <h2>Dengarkan Kota Anda Berbicara!</h2>
            <p>Selamat datang di platform podcast "Kota Berbicara" yang inovatif. Di sini, Anda dapat menikmati podcast informatif tentang kota cerdas atau membuat podcast kustom Anda sendiri tentang topik smart city. Dapatkan informasi terkini tentang berita lokal, penanganan bencana, program pemerintah, dan banyak lagi dalam format yang menarik dan mudah diakses.</p>
        </div>

        <div class="tabs fade-in">
            <button class="tab-btn active" data-tab="explore">Jelajahi Podcast</button>
            <button class="tab-btn" data-tab="generate">Buat Podcast Kustom</button>
            <button class="tab-btn" data-tab="settings">Pengaturan</button>
        </div>

        <!-- Tab Jelajahi Podcast - Berisi koleksi podcast yang sudah ada -->
        <div id="explore" class="tab-content active fade-in">
            <h3>Podcast Smart City Eksklusif</h3>
            <p>Dengarkan podcast eksklusif kami tentang kota cerdas dan perkembangannya di Indonesia.</p>

            <div class="search-box">
                <input type="text" id="search-city" placeholder="Cari kota atau topik...">
                <button><i class="fas fa-search"></i></button>
            </div>

            <h4>Filter berdasarkan kota:</h4>
            <div class="podcast-categories" style="margin: 1.5rem 0">
                <span class="category-tag active">Semua</span>
                <span class="category-tag">Jakarta</span>
                <span class="category-tag">Surabaya</span>
                <span class="category-tag">Bandung</span>
                <span class="category-tag">Makassar</span>
                <span class="category-tag">Yogyakarta</span>
                <span class="category-tag" id="more-cities">Kota Lainnya...</span>
            </div>

            <div id="podcastContainer">
                <!-- Podcast 1 -->
                <div class="podcast-video-card" data-city="Yogyakarta">
                    <div class="podcast-thumbnail">
                        <img src="https://via.placeholder.com/320x180/4caf50/ffffff?text=Yogyakarta+Smart" alt="Thumbnail Podcast">
                        <div class="city-label">Yogyakarta</div>
                        <div class="play-overlay">
                            <div class="play-icon">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                    </div>
                    <div class="podcast-video-info">
                        <div class="podcast-video-title">Transformasi Layanan Publik: Aplikasi e-Government di Yogyakarta</div>
                        <div class="podcast-video-meta">
                            <span>Sari & Doni</span>
                            <span>9:48 • 28 Okt 2023</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detail Podcast yang Dimainkan -->
            <h4 style="margin-top: 30px;">Sedang Diputar</h4>
            <div class="podcast-player">
                <div class="play-btn" id="play-btn">
                    <i class="fas fa-play"></i>
                </div>
                <div class="podcast-info">
                    <div class="podcast-title" id="player-title">Select a podcast to play</div>
                    <div class="podcast-meta" id="player-meta">
                        <span><i class="fas fa-microphone"></i> —</span>
                        <span><i class="fas fa-map-marker-alt"></i> —</span>
                        <span><i class="fas fa-clock"></i> 00:00</span>
                        <span><i class="fas fa-calendar"></i> —</span>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <div class="duration">
                        <span id="current-time">00:00</span>
                        <span id="total-time">00:00</span>
                    </div>
                </div>

                <!-- The actual audio element -->
                <audio id="audio-player"></audio>
            </div>
        </div>

        <!-- Tab Generate Podcast - Untuk membuat podcast baru yang akan diunduh -->
        <div id="generate" class="tab-content fade-in">
            <h3>Buat Podcast Kustom</h3>
            <p>Masukkan informasi untuk menghasilkan podcast yang sesuai dengan kebutuhan Anda. Podcast akan dihasilkan dan siap diunduh setelah proses selesai.</p>

            <form id="podcast-form">
                <div class="form-group">
                    <label for="podcast-title">Judul Podcast</label>
                    <input type="text" id="podcast-title" placeholder="Contoh: Perkembangan Smart City di Jakarta" required>
                </div>

                <div class="form-group">
                    <label for="podcast-description">Deskripsi atau Topik</label>
                    <textarea id="podcast-description" placeholder="Jelaskan topik podcast yang ingin Anda buat. Semakin detail, semakin baik hasilnya..." required></textarea>
                </div>

                <div class="form-group">
                    <label>Referensi Konten (Opsional)</label>
                    <div class="file-upload" id="file-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Tarik & lepas file di sini, atau klik untuk memilih</p>
                        <p class="small">Mendukung PDF, DOCX, MP3, MP4 (Maks. 50MB)</p>
                        <input type="file" id="file-input" multiple accept=".pdf,.docx,.doc,.txt,.mp3,.mp4">
                    </div>

                    <div class="file-list" id="file-list">
                        <!-- File items will appear here -->
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-magic"></i> Buat & Unduh Podcast
                </button>
            </form>

            <!-- Download Progress (muncul setelah tombol Generate ditekan) -->
            <div class="download-progress" id="download-progress">
                <div class="loading-spinner"></div>
                <h4 style="margin-top: 1rem;">Menghasilkan Podcast Anda</h4><br>
                <p>Mohon tunggu sebentar.<br> Proses ini bisa memakan waktu 1-3 menit.</p>
            </div>

            <!-- Download Success (muncul setelah proses selesai) -->
            <div class="download-success" id="download-success">
                <i class="fas fa-check-circle"></i>
                <h4>Podcast Berhasil Dibuat!</h4>
                <p>Podcast Anda telah berhasil dibuat dan siap diunduh.</p>

                <div style="margin-top: 1.5rem;">
                    <a href="#" class="btn btn-primary" id="download-link">
                        <i class="fas fa-download"></i> Unduh Podcast (.mp3)
                    </a>
                    <button class="btn btn-secondary" id="create-another">
                        <i class="fas fa-plus"></i> Buat Podcast Lain
                    </button>
                </div>
            </div>
        </div>

        <!-- Tab Pengaturan - Untuk mengatur preferensi podcast -->
        <div id="settings" class="tab-content fade-in">
            <h3>Pengaturan Podcast</h3>
            <p>Sesuaikan pengaturan untuk podcast yang akan dihasilkan melalui fitur "Buat Podcast Kustom".</p>

            <div class="settings-grid">
                <div class="form-group">
                    <label for="language">Bahasa</label>
                    <select id="language">
                        <option value="bahasa indonesia" selected>Bahasa Indonesia</option>
                        <option value="english">English</option>
                        <option value="javanese">Bahasa Jawa</option>
                        <option value="sundanese">Bahasa Sunda</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="duration">Durasi (menit)</label>
                    <input type="range" id="duration" class="range-slider" min="1" max="30" value="5" step="1">
                    <div class="range-info">
                        <span>3 menit</span>
                        <span id="duration-value">5 menit</span>
                        <span>30 menit</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="format">Format Podcast</label>
                    <select id="format">
                        <option value="interview" selected>Wawancara</option>
                        <option value="narration">Narasi</option>
                        <option value="discussion">Diskusi Panel</option>
                        <option value="news">Berita</option>
                        <option value="educational">Edukatif</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="style">Gaya Penyampaian</label>
                    <select id="style">
                        <option value="formal" selected>Formal</option>
                        <option value="casual">Santai</option>
                        <option value="humorous">Humoris</option>
                        <option value="dramatic">Dramatis</option>
                    </select>
                </div>

                <div class="form-group">
                    <div class="toggle-label">
                        <span>Musik Latar</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="background-music" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="speaker-selection">
                <h4>Pilih Pembawa Acara (1-2 orang)</h4>
                <p>Pilih suara yang akan digunakan dalam podcast Anda.</p>

                <div class="speaker-grid">
                    <div class="speaker-card" data-id="Budi Santoso">
                        <div class="speaker-avatar">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Budi">
                        </div>
                        <div class="speaker-name">Budi Santoso</div>
                        <div class="speaker-desc">Suara maskulin & formal</div>
                    </div>

                    <div class="speaker-card" data-id="Andi Prasetyo">
                        <div class="speaker-avatar">
                            <img src="https://randomuser.me/api/portraits/men/75.jpg" alt="Andi">
                        </div>
                        <div class="speaker-name">Andi Prasetyo</div>
                        <div class="speaker-desc">Suara berat & santai</div>
                    </div>

                    <div class="speaker-card" data-id="Doni Kusuma">
                        <div class="speaker-avatar">
                            <img src="https://randomuser.me/api/portraits/men/42.jpg" alt="Doni">
                        </div>
                        <div class="speaker-name">Doni Kusuma</div>
                        <div class="speaker-desc">Suara muda & energik</div>
                    </div>

                    <div class="speaker-card" data-id="Sari Indah">
                        <div class="speaker-avatar">
                            <img src="https://randomuser.me/api/portraits/women/33.jpg" alt="Sari">
                        </div>
                        <div class="speaker-name">Sari Indah</div>
                        <div class="speaker-desc">Suara lembut & profesional</div>
                    </div>

                    <div class="speaker-card" data-id="Maya Putri">
                        <div class="speaker-avatar">
                            <img src="https://randomuser.me/api/portraits/women/62.jpg" alt="Maya">
                        </div>
                        <div class="speaker-name">Maya Putri</div>
                        <div class="speaker-desc">Suara ekspresif & ceria</div>
                    </div>

                    <div class="speaker-card" data-id="Dina Wijaya">
                        <div class="speaker-avatar">
                            <img src="https://randomuser.me/api/portraits/women/89.jpg" alt="Dina">
                        </div>
                        <div class="speaker-name">Dina Wijaya</div>
                        <div class="speaker-desc">Suara tegas & artikulatif</div>
                    </div>
                </div>
            </div>

            <div class="button-wrapper">
                <button class="btn btn-primary" id="save-settings">
                <i class="fas fa-save"></i> Simpan Pengaturan
                </button>
            </div>
        </div>
    </main>

    <!-- Modal untuk memilih kota -->
    <div class="city-modal-backdrop" id="city-modal-backdrop">
        <div class="city-modal">
            <div class="city-modal-header">
                <div class="city-modal-title">Pilih Kota</div>
                <button class="city-modal-close" id="close-city-modal">&times;</button>
            </div>
            <div class="city-modal-body">
                <input type="text" class="city-search" id="city-search" placeholder="Cari kota...">

                <div class="city-grid" id="city-grid">
                    <span class="category-tag">Jakarta</span>
                    <span class="category-tag">Surabaya</span>
                    <span class="category-tag">Bandung</span>
                    <span class="category-tag">Bekasi</span>
                    <span class="category-tag">Medan</span>
                    <span class="category-tag">Depok</span>
                    <span class="category-tag">Tangerang</span>
                    <span class="category-tag">Palembang</span>
                    <span class="category-tag">Semarang</span>
                    <span class="category-tag">Makassar</span>
                    <span class="category-tag">Tangerang Selatan</span>
                    <span class="category-tag">Batam</span>
                    <span class="category-tag">Pekanbaru</span>
                    <span class="category-tag">Bogor</span>
                    <span class="category-tag">Bandar Lampung</span>
                    <span class="category-tag">Padang</span>
                    <span class="category-tag">Malang</span>
                    <span class="category-tag">Samarinda</span>
                    <span class="category-tag">Tasikmalaya</span>
                    <span class="category-tag">Serang</span>
                    <span class="category-tag">Balikpapan</span>
                    <span class="category-tag">Pontianak</span>
                    <span class="category-tag">Banjarmasin</span>
                    <span class="category-tag">Denpasar</span>
                    <span class="category-tag">Jambi</span>
                    <span class="category-tag">Surakarta</span>
                    <span class="category-tag">Cimahi</span>
                    <span class="category-tag">Cilegon</span>
                    <span class="category-tag">Mataram</span>
                    <span class="category-tag">Manado</span>
                    <span class="category-tag">Yogyakarta</span>
                    <span class="category-tag">Jayapura</span>
                    <span class="category-tag">Kupang</span>
                    <span class="category-tag">Bengkulu</span>
                    <span class="category-tag">Palu</span>
                    <span class="category-tag">Sukabumi</span>
                    <span class="category-tag">Kendari</span>
                    <span class="category-tag">Ambon</span>
                    <span class="category-tag">Cirebon</span>
                    <span class="category-tag">Dumai</span>
                    <span class="category-tag">Pekalongan</span>
                    <span class="category-tag">Binjai</span>
                    <span class="category-tag">Palangka Raya</span>
                    <span class="category-tag">Kediri</span>
                    <span class="category-tag">Tegal</span>
                    <span class="category-tag">Sorong</span>
                    <span class="category-tag">Banjarbaru</span>
                    <span class="category-tag">Pematangsiantar</span>
                    <span class="category-tag">Banda Aceh</span>
                    <span class="category-tag">Tarakan</span>
                    <span class="category-tag">Singkawang</span>
                    <span class="category-tag">Lubuk Linggau</span>
                    <span class="category-tag">Probolinggo</span>
                    <span class="category-tag">Pangkalpinang</span>
                    <span class="category-tag">Tanjungpinang</span>
                    <span class="category-tag">Padang Sidempuan</span>
                    <span class="category-tag">Batu</span>
                    <span class="category-tag">Bitung</span>
                    <span class="category-tag">Prabumulih</span>
                    <span class="category-tag">Pasuruan</span>
                    <span class="category-tag">Ternate</span>
                    <span class="category-tag">Banjar</span>
                    <span class="category-tag">Gorontalo</span>
                    <span class="category-tag">Madiun</span>
                    <span class="category-tag">Salatiga</span>
                    <span class="category-tag">Lhokseumawe</span>
                    <span class="category-tag">Bontang</span>
                    <span class="category-tag">Tanjungbalai</span>
                    <span class="category-tag">Tebing Tinggi</span>
                    <span class="category-tag">Langsa</span>
                    <span class="category-tag">Palopo</span>
                    <span class="category-tag">Metro</span>
                    <span class="category-tag">Bima</span>
                    <span class="category-tag">Baubau</span>
                    <span class="category-tag">Parepare</span>
                    <span class="category-tag">Blitar</span>
                    <span class="category-tag">Pagar Alam</span>
                    <span class="category-tag">Payakumbuh</span>
                    <span class="category-tag">Mojokerto</span>
                    <span class="category-tag">Bukittinggi</span>
                    <span class="category-tag">Gunungsitoli</span>
                    <span class="category-tag">Magelang</span>
                    <span class="category-tag">Tidore Kepulauan</span>
                    <span class="category-tag">Kotamobagu</span>
                    <span class="category-tag">Subulussalam</span>
                    <span class="category-tag">Pariaman</span>
                    <span class="category-tag">Tomohon</span>
                    <span class="category-tag">Sungaipenuh</span>
                    <span class="category-tag">Sibolga</span>
                    <span class="category-tag">Tual</span>
                    <span class="category-tag">Solok</span>
                    <span class="category-tag">Sawahlunto</span>
                    <span class="category-tag">Padang Panjang</span>
                    <span class="category-tag">Sabang</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal untuk peringatan durasi -->
    <div class="city-modal-backdrop" id="duration-warning-modal">
        <div class="city-modal" style="max-width: 500px;">
            <div class="city-modal-header">
                <div class="city-modal-title">Batasan Durasi</div>
                <button class="city-modal-close" id="close-duration-warning">&times;</button>
            </div>
            <div class="city-modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <i class="fas fa-exclamation-circle" style="font-size: 48px; color: var(--warning);"></i>
                </div>
                <h4 style="margin-bottom: 15px;">Durasi Terbatas</h4>
                <p>Untuk versi saat ini, karena keterbatasan resource, durasi podcast hanya dapat diatur maksimal 5 menit.</p>
                <p style="margin-top: 15px;">Pada pembaruan mendatang, kami akan meningkatkan kemampuan platform untuk menghasilkan podcast dengan durasi yang lebih panjang.</p>
                <div style="text-align: center; margin-top: 25px;">
                    <button class="btn btn-primary" id="understand-btn">Saya Mengerti</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container footer-content" id="footer">
            <div class="footer-col">
                <h3>Tentang Kota Berbicara</h3>
                <p>Kota Berbicara adalah platform inovatif yang menghubungkan warga dengan kota mereka melalui podcast informatif yang dihasilkan oleh AI. Kami berkomitmen untuk menyediakan informasi terkini tentang pembangunan kota cerdas di Indonesia.</p>
            </div>

            <div class="footer-col">
            </div>

            <div class="footer-col">
                <h3>Hubungi Kami</h3>
                <p><i class="fas fa-envelope"></i> matthew.lefrandt@binus.ac.id (Matthew)</p>
                <p><i class="fas fa-envelope"></i> salomo.sudjono@binus.ac.id (Salomo)</p>
                <p><i class="fas fa-phone"></i> +62 878 8637 4599 (Matthew)</p>
                <p><i class="fas fa-phone"></i> +62 851 5544 7960 (Salomo)</p>

                <div class="social-links">
                    <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
        </div>

        <div class="copyright">
            &copy; 2025 Kota Berbicara. Hak Cipta Dilindungi.
        </div>
    </footer>

    <div class="toast" id="toast">Pengaturan berhasil disimpan!</div>

    <script>

        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('data-target');
            document.getElementById(targetId).scrollIntoView({
                behavior: 'smooth'
            });
            });
        });
        let currentAudio = null;
        // let isPlaying = false;
        async function loadPodcasts() {
            try {
                const res = await fetch('https://compfest-podcast-generator-salomohs-salomo-hendrians-projects.vercel.app/fetch_podcast'); // your API endpoint
                const data = await res.json();
                
                const container = document.getElementById('podcastContainer');
                container.innerHTML = ''; // clear existing content

                data.podcasts.forEach(podcast => {
                    const card = document.createElement('div');
                    card.classList.add('podcast-video-card');
                    card.setAttribute('data-city', podcast.city?.cityName || '');

                    card.innerHTML = `
                        <div class="podcast-thumbnail">
                            <img src="https://dbdlxpquyiwpntlsizle.supabase.co/storage/v1/object/public/assets/Kota%20Berbicara-watermark.png" alt="Thumbnail Podcast">
                            <div class="podcast-video-meta-1">
                                <div class="city-label">${podcast.city?.cityName || ''}</div>
                                <div class="duration-label">${podcast?.duration || '345'}</div>
                            </div>
                            
                            <div class="play-overlay">
                                <div class="play-btn">
                                    <i class="fas fa-play"></i>
                                </div>
                            </div>
                        </div>
                        <div class="podcast-video-info">
                            <div class="podcast-video-title">${podcast?.title || 'TITLE'}</div>
                            <div class="podcast-video-speaker">
                                <span>${podcast.speaker1?.speakerName || 'SPEKAER'} & ${podcast.speaker2?.speakerName || 'SPEKAER'}</span>
                            </div>
                            <div class="podcast-video-meta">
                                <span class="accent-info">${podcast.language?.languageName || 'Accent'}</span>
                                <span>${podcast.createdAt} ${podcast.timezone}</span>
                            </div>
                        </div>
                    `;
                    card.addEventListener('click', () => loadIntoPlayer(podcast));    
                    container.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading podcasts:', error);
            }
        }

        function loadIntoPlayer(podcast) {
            const audio = document.getElementById('audio-player');
            const title = document.getElementById('player-title');
            const meta = document.getElementById('player-meta');
            const playBtn = document.getElementById('play-btn');
            
            audio.pause();
                audio.currentTime = 0;

                audio.src = podcast.audio;
                title.textContent = podcast.title;
                meta.innerHTML = `
                    <span><i class="fas fa-microphone"></i> ${podcast.speaker1?.speakerName || 'SPEKAER'} & ${podcast.speaker2?.speakerName || 'SPEKAER'} </span>

                    <span><i class="fas fa-map-marker-alt"></i> ${podcast.city.cityName}</span>
                    <span><i class="fas fa-clock"></i> ${podcast.duration}</span>
                    <span><i class="fas fa-calendar"></i> ${podcast.createdAt}</span>
                `;

                audio.play();
                currAudio = audio
                isPlaying = true;
                playBtn.innerHTML = '<i class="fas fa-pause"></i>';
        }

        // Load when page opens
        document.addEventListener('DOMContentLoaded', loadPodcasts);
        // Tab switching functionality
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');

        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.getAttribute('data-tab');

                // Remove active class from all buttons and contents
                tabBtns.forEach(b => b.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));

                // Add active class to current button and content
                btn.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Speaker selection functionality
        const speakerCards = document.querySelectorAll('.speaker-card');
        let selectedSpeakers = [];

        speakerCards.forEach(card => {
            card.addEventListener('click', () => {
                const speakerId = card.getAttribute('data-id');

                if (card.classList.contains('selected')) {
                    // Deselect speaker
                    card.classList.remove('selected');
                    selectedSpeakers = selectedSpeakers.filter(id => id !== speakerId);
                } else {
                    // Select speaker (max 2)
                    if (selectedSpeakers.length < 2) {
                        card.classList.add('selected');
                        selectedSpeakers.push(speakerId);
                    } else {
                        showToast('Maksimal 2 pembawa acara yang dapat dipilih', 'error');
                    }
                }
            });
        });

        // Duration slider with warning
        const durationSlider = document.getElementById('duration');
        const durationValue = document.getElementById('duration-value');
        const durationWarningModal = document.getElementById('duration-warning-modal');
        const closeDurationWarning = document.getElementById('close-duration-warning');
        const understandBtn = document.getElementById('understand-btn');

        durationSlider.addEventListener('input', () => {
            const value = parseInt(durationSlider.value);
            durationValue.textContent = `${value} menit`;

            // Tampilkan peringatan jika durasi > 5 menit
            if (value > 5) {
                durationWarningModal.style.display = 'flex';
                document.body.style.overflow = 'hidden'; // Mencegah scrolling

                // Reset nilai slider ke 5 menit
                setTimeout(() => {
                    durationSlider.value = 5;
                    durationValue.textContent = '5 menit';
                }, 100);
            }
        });

        // Tutup modal peringatan durasi
        function closeDurationWarningModal() {
            durationWarningModal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Kembalikan scrolling
        }

        closeDurationWarning.addEventListener('click', closeDurationWarningModal);
        understandBtn.addEventListener('click', closeDurationWarningModal);

        // Juga tutup modal ketika klik di luar modal
        durationWarningModal.addEventListener('click', (e) => {
            if (e.target === durationWarningModal) {
                closeDurationWarningModal();
            }
        });

        // File upload handling
        const fileUploadArea = document.getElementById('file-upload-area');
        const fileInput = document.getElementById('file-input');
        const fileList = document.getElementById('file-list');

        fileUploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.style.borderColor = 'var(--primary)';
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.style.borderColor = '#ddd';
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.style.borderColor = '#ddd';

            if (e.dataTransfer.files.length > 0) {
                handleFiles(e.dataTransfer.files);
            }
        });

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                handleFiles(fileInput.files);
            }
        });

        let selectedFiles = []
        function handleFiles(files) {
            for (let i = 0; i < files.length; i++) {
                const file = files[i];

                // Check file size (max 50MB)
                if (file.size > 50 * 1024 * 1024) {
                    showToast(`File ${file.name} terlalu besar. Maksimal 50MB.`, 'error');
                    continue;
                }

                // Add file to the list
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';

                let fileIcon = 'fa-file';
                if (file.type.includes('pdf')) fileIcon = 'fa-file-pdf';
                else if (file.type.includes('word') || file.name.endsWith('.docx') || file.name.endsWith('.doc')) fileIcon = 'fa-file-word';
                else if (file.type.includes('audio')) fileIcon = 'fa-file-audio';
                else if (file.type.includes('video')) fileIcon = 'fa-file-video';
                else if (file.type.includes('text')) fileIcon = 'fa-file-alt';

                fileItem.innerHTML = `
                    <span><i class="fas ${fileIcon}"></i> ${file.name}</span>
                    <i class="fas fa-times remove-file"></i>
                `;

                fileList.appendChild(fileItem);
                selectedFiles.push(file);
                // Add remove functionality
                const removeBtn = fileItem.querySelector('.remove-file');
                removeBtn.addEventListener('click', () => {
                    fileItem.remove();
                });
            }
        }

        // Toast notification function
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast show';

            if (type === 'error') {
                toast.classList.add('error');
            } else if (type === 'success') {
                toast.classList.add('success');
            }

            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.classList.remove('error', 'success');
                }, 300);
            }, 3000);
        }

        // Save settings button
        document.getElementById('save-settings').addEventListener('click', () => {
            if (selectedSpeakers.length === 0) {
                showToast('Pilih minimal 1 pembawa acara', 'error');
                return;
            }
            showToast('Pengaturan berhasil disimpan!');
        });

        // Form submission (generate podcast for download)
        document.getElementById('podcast-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const title = document.getElementById('podcast-title').value;
            const description = document.getElementById('podcast-description').value;

            if (!title || !description) {
                showToast('Mohon isi semua informasi yang diperlukan', 'error');
                return;
            }

            // Hide form and show download progress
            document.getElementById('podcast-form').style.display = 'none';
            document.getElementById('download-progress').style.display = 'block';

            // Simulate progress
            let progress = 0;
            const progressBar = document.getElementById('progress-bar-fill');
            const progressText = document.getElementById('progress-text');

            const formData = new FormData();
            formData.append('description', description);
            formData.append('language',document.getElementById("language").value)
            formData.append('duration',document.getElementById("duration").value)
            formData.append('style',document.getElementById("style").value)
            formData.append('format',document.getElementById("format").value)
            formData.append('bgm',document.getElementById("background-music").checked)
            formData.append('speakers',selectedSpeakers)
            selectedFiles.forEach(file => {
                formData.append("files", file); // send as array
            });

            try {
                const response = await fetch('https://compfest-podcast-generator-salomohs-salomo-hendrians-projects.vercel.app/generate_podcast', {
                    method: 'POST',
                    body: formData
                })

                const data = await response.json() 
                

                if (!response.ok) {
                    throw new Error('Terjadi kesalahan saat mengirim permintaan.');
                }
                document.getElementById('download-progress').style.display = 'none';
                document.getElementById('download-success').style.display = 'block';

                const downloadLink = document.getElementById('download-link');
                downloadLink.setAttribute('file-name', `${title.replace(/\s+/g, '_')}.mp3`);
                downloadLink.setAttribute('url', data.public_url);
                 // In a real application, this would be the actual file URL
                showToast('Podcast berhasil dibuat!', 'success');
            } catch (error) {
                alert('Gagal membuat podcast: Penggunaan melebihi kapasitas.' +  '\nMohon dapat menghubungi kami melalui whatsapp +6287886374599 (Matthew)');
            }
        });

        // Create another podcast button
        document.getElementById('create-another').addEventListener('click', () => {
            // Reset form
            document.getElementById('podcast-form').reset();
            document.getElementById('file-list').innerHTML = '';
            selectedFiles = []

            // Show form again
            document.getElementById('download-success').style.display = 'none';
            document.getElementById('podcast-form').style.display = 'block';

            showToast('Siap membuat podcast baru!');
        });

        // Download link click handler
        document.getElementById('download-link').addEventListener('click', (e) => {
            const downloadLink = document.getElementById('download-link');
            
            downloadLink.href = downloadLink.getAttribute("url") + 'download=' + downloadLink.getAttribute("file-name");
            // In a real application, this would actually download the file
            // For demo purposes, we're just showing a toast
            showToast('Mengunduh podcast Anda...', 'success');
        });

        // Play button functionality for the main player
        let isPlaying = false;
        let currAudio
        document.getElementById('play-btn').addEventListener('click', () => {
            const audio = document.getElementById('audio-player');
            
            if (!audio.src) return; // No podcast loaded yet

            if (isPlaying) {
                
                if (audio != currAudio && currAudio) {
                    audio.play();
                    audio.currentTime = 0;
                } else{
                audio.pause();
                    document.getElementById('play-btn').innerHTML = '<i class="fas fa-play"></i>';
                }
            }  
            else {
                audio.play();
                document.getElementById('play-btn').innerHTML = '<i class="fas fa-pause"></i>';
                currAudio = audio
            }
            isPlaying = !isPlaying;
        });

        // Progress bar & time update
        
        document.getElementById('audio-player').addEventListener('timeupdate', () => {
            const audio = document.getElementById('audio-player');
            const progressBar = document.getElementById('progress-bar');
            const currentTimeElem = document.getElementById('current-time');
            const totalTimeElem = document.getElementById('total-time');

            const progress = (audio.currentTime / audio.duration) * 100;
            progressBar.style.width = `${progress}%`;

            currentTimeElem.textContent = formatTime(audio.currentTime);
            totalTimeElem.textContent = formatTime(audio.duration);
        });
        const progressContainer = document.querySelector('.progress-container');
const audio = document.getElementById('audio-player');
let isDragging = false;

// Function to update audio time based on click/drag position
function updateAudioTime(e) {
    const rect = progressContainer.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const containerWidth = rect.width;
    const clickPercentage = Math.max(0, Math.min(1, clickX / containerWidth));
    
    if (audio.duration) {
        audio.currentTime = clickPercentage * audio.duration;
    }
}

// Click to seek
progressContainer.addEventListener('click', (e) => {
    if (!isDragging) {
        updateAudioTime(e);
    }
});

// Mouse down - start dragging
progressContainer.addEventListener('mousedown', (e) => {
    isDragging = true;
    updateAudioTime(e);
    progressContainer.classList.add('dragging');
});

// Mouse move - continue dragging
document.addEventListener('mousemove', (e) => {
    if (isDragging) {
        updateAudioTime(e);
    }
});

// Mouse up - stop dragging
document.addEventListener('mouseup', () => {
    if (isDragging) {
        isDragging = false;
        progressContainer.classList.remove('dragging');
    }
});

// Touch events for mobile support
progressContainer.addEventListener('touchstart', (e) => {
    isDragging = true;
    const touch = e.touches[0];
    updateAudioTime(touch);
    progressContainer.classList.add('dragging');
    e.preventDefault();
});

document.addEventListener('touchmove', (e) => {
    if (isDragging) {
        const touch = e.touches[0];
        updateAudioTime(touch);
        e.preventDefault();
    }
});

document.addEventListener('touchend', () => {
    if (isDragging) {
        isDragging = false;
        progressContainer.classList.remove('dragging');
    }
});

        function formatTime(seconds) {
            if (isNaN(seconds)) return '00:00';
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }



        // Make podcast video cards clickable
        document.querySelectorAll('.podcast-video-card').forEach(card => {
            card.addEventListener('click', () => {
                // Update the main player with this podcast's info
                const title = card.querySelector('.podcast-video-title').textContent;
                const cityLabel = card.querySelector('.city-label').textContent;

                document.querySelector('.podcast-title').textContent = title;

                // Update city in the meta data
                const metaElements = document.querySelectorAll('.podcast-meta span');
                metaElements[1].innerHTML = `<i class="fas fa-map-marker-alt"></i> ${cityLabel}`;

                // Scroll to the player
                document.querySelector('.podcast-player').scrollIntoView({ behavior: 'smooth' });

                // Show "playing" animation
                playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                isPlaying = true;

                showToast(`Memutar podcast: ${title}`);
            });
        });

        // City modal functionality
        const cityModalBackdrop = document.getElementById('city-modal-backdrop');
        const closeModalBtn = document.getElementById('close-city-modal');
        const moreCitiesBtn = document.getElementById('more-cities');
        const citySearch = document.getElementById('city-search');
        const cityGrid = document.getElementById('city-grid');
        const cityTags = cityGrid.querySelectorAll('.category-tag');

        // Open city modal
        moreCitiesBtn.addEventListener('click', () => {
            cityModalBackdrop.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Prevent scrolling
            citySearch.focus();
        });

        // Close city modal
        closeModalBtn.addEventListener('click', closeModal);

        cityModalBackdrop.addEventListener('click', (e) => {
            if (e.target === cityModalBackdrop) {
                closeModal();
            }
        });

        function closeModal() {
            cityModalBackdrop.style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore scrolling
            citySearch.value = '';
            filterCities('');
        }

        // Filter cities in modal
        citySearch.addEventListener('input', () => {
            filterCities(citySearch.value.toLowerCase());
        });

        function filterCities(searchTerm) {
            cityTags.forEach(tag => {
                const cityName = tag.textContent.toLowerCase();
                if (cityName.includes(searchTerm)) {
                    tag.style.display = 'inline-block';
                } else {
                    tag.style.display = 'none';
                }
            });
        }

        // Select city from modal
        cityTags.forEach(tag => {
            tag.addEventListener('click', () => {
                const selectedCity = tag.textContent;

                // Add the city to the main filter if it's not already there
                const mainCategories = document.querySelector('.podcast-categories');

                // Check if city already exists in the filter
                let cityExists = false;
                document.querySelectorAll('.podcast-categories .category-tag').forEach(existingTag => {
                    if (existingTag.textContent === selectedCity && existingTag.id !== 'more-cities') {
                        cityExists = true;
                        existingTag.click(); // Activate the existing tag
                    }
                });

                // If city doesn't exist, add it and make it active
                if (!cityExists) {
                    // Deactivate all current tags
                    document.querySelectorAll('.podcast-categories .category-tag').forEach(t => t.classList.remove('active'));

                    // Create new tag and add it before "Kota Lainnya"
                    const newTag = document.createElement('span');
                    newTag.className = 'category-tag active';
                    newTag.textContent = selectedCity;
                    newTag.addEventListener('click', function() {
                        // Same functionality as other tags
                        document.querySelectorAll('.category-tag').forEach(t => t.classList.remove('active'));
                        this.classList.add('active');

                        // Filter podcast cards
                        const cityFilter = this.textContent.trim();
                        const podcastCards = document.querySelectorAll('.podcast-video-card');

                        podcastCards.forEach(card => {
                            const cityLabel = card.getAttribute('data-city');

                            if (cityFilter === 'Semua' || cityLabel === cityFilter) {
                                card.style.display = 'block';
                            } else {
                                card.style.display = 'none';
                            }
                        });

                        showToast(`Menampilkan podcast dari ${cityFilter}`);
                    });

                    mainCategories.insertBefore(newTag, moreCitiesBtn);

                    // Filter podcast cards
                    const podcastCards = document.querySelectorAll('.podcast-video-card');
                    podcastCards.forEach(card => {
                        const cityLabel = card.getAttribute('data-city');

                        if (cityLabel === selectedCity) {
                            card.style.display = 'block';
                        } else {
                            card.style.display = 'none';
                        }
                    });

                    showToast(`Menampilkan podcast dari ${selectedCity}`);
                }

                closeModal();
            });
        });

        // Category tags click handler
        document.querySelectorAll('.podcast-categories .category-tag').forEach(tag => {
            if (tag.id !== 'more-cities') {
                tag.addEventListener('click', () => {
                    // Remove active class from all tags
                    document.querySelectorAll('.category-tag').forEach(t => t.classList.remove('active'));

                    // Add active class to clicked tag
                    tag.classList.add('active');

                    // Filter cards based on city selection (except "Semua")
                    const cityFilter = tag.textContent.trim();
                    const podcastCards = document.querySelectorAll('.podcast-video-card');

                    podcastCards.forEach(card => {
                        const cityLabel = card.getAttribute('data-city');

                        if (cityFilter === 'Semua' || cityLabel === cityFilter) {
                            card.style.display = 'block';
                        } else {
                            card.style.display = 'none';
                        }
                    });

                    // Show filter applied notification
                    showToast(`Menampilkan podcast dari ${cityFilter}`);
                });
            }
        });

        // Search functionality
        const searchInput = document.getElementById('search-city');
        searchInput.addEventListener('input', () => {
            const searchTerm = searchInput.value.toLowerCase();
            const podcastCards = document.querySelectorAll('.podcast-video-card');

            podcastCards.forEach(card => {
                const title = card.querySelector('.podcast-video-title').textContent.toLowerCase();
                const city = card.getAttribute('data-city').toLowerCase();

                if (title.includes(searchTerm) || city.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });

            // If there's an active filter, deactivate it
            if (searchTerm !== '') {
                document.querySelectorAll('.category-tag').forEach(tag => tag.classList.remove('active'));
                document.querySelector('.category-tag:first-child').classList.add('active');
            }
        });

        // Set default selected speaker
        document.querySelector('.speaker-card[data-id="speaker1"]').classList.add('selected');
        selectedSpeakers.push('speaker1');
    </script>
</body>
</html>
